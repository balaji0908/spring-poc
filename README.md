# spring-poc
Project will have pocs on spring concepts



For JPA Auditing PLease follow below steps:-
1)Below queries need to be executed(auditing is the schema name)
-- this sequence is required but double whether the table revinfo gets created by default
CREATE SEQUENCE hibernate_sequence  INCREMENT 1  MINVALUE 1
  MAXVALUE 9223372036854775807
  START 1;
  
  
CREATE TABLE auditing.revinfo (
    rev INTEGER GENERATED BY DEFAULT AS IDENTITY,
    revtstmp timestamp,
    username VARCHAR(255),
    PRIMARY KEY (REV)
);

2) Incase you want to create the table then use the below script

CREATE TABLE auditing.employee_aud (
	id int8 NOT NULL,
	rev int4 NOT NULL,
	revtype int2 NULL,
	company varchar(255) NULL,
	first_name varchar(255) NULL,
	last_name varchar(255) NULL,
	PRIMARY KEY (id, rev),
	FOREIGN KEY (rev) REFERENCES revinfo(rev)
)
WITH (
	OIDS=FALSE
) ;

3)Usse below query to fetch data fron Revision & AUdit table

SELECT REVINFO.REV, REVINFO.REVTSTMP, REVINFO.USERNAME,
 employee_aud.ID, employee_aud.company, 
 CASE 
    WHEN employee_aud.REVTYPE = 0 THEN 'add' 
    WHEN employee_aud.REVTYPE = 1 THEN 'mod' 
    WHEN employee_aud.REVTYPE = 2 THEN 'del' 
 ELSE NULL END AS REVTYPE
 FROM REVINFO
 LEFT JOIN employee_aud ON REVINFO.REV = employee_aud.REV
